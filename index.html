<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Exam Portal</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --glass: rgba(255,255,255,0.12);
    --glass-2: rgba(255,255,255,0.20);
    --accent: #1976d2;
    --accent-dark: #0d47a1;
    --white: #ffffff;
    --card-shadow: 0 10px 30px rgba(0,0,0,0.25);
  }
  *{box-sizing:border-box;font-family:'Poppins',sans-serif}
  body{
    margin:0;
    min-height:100vh;
    background: linear-gradient(135deg,#0d47a1 0%, #1976d2 50%, #42a5f5 100%);
    color:var(--white);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    padding:24px 12px;
  }

  header{
    text-align:center;
    padding:20px;
    margin-bottom:18px;
    background:var(--glass);
    backdrop-filter:blur(8px);
    border-radius:14px;
    box-shadow:var(--card-shadow);
    border:1px solid rgba(255,255,255,0.06);
  }
  header h1{margin:0;font-size:22px;font-weight:700;letter-spacing:0.2px}

  .container{
    max-width:1000px;
    margin:10px auto;
  }

  .menu{
    display:flex;
    gap:12px;
    justify-content:center;
    margin-bottom:18px;
  }

  .menu button{
    background:rgba(255,255,255,0.08);
    color:var(--white);
    border:1px solid rgba(255,255,255,0.08);
    padding:10px 18px;
    border-radius:999px;
    cursor:pointer;
    transition:0.28s;
    font-weight:600;
  }
  .menu button:hover{
    transform:translateY(-3px);
    background:var(--accent);
    box-shadow:0 10px 20px rgba(0,0,0,0.25);
  }

  .page{display:none}
  .card{
    background: var(--glass);
    border-radius:14px;
    padding:18px;
    border:1px solid rgba(255,255,255,0.08);
    box-shadow:var(--card-shadow);
    color:#fff;
  }

  h2 { margin-top:0; margin-bottom:10px; font-weight:600; text-align:center }

  form.grid{
    display:grid;
    grid-template-columns:repeat(2,1fr);
    gap:14px;
    align-items:start;
  }

  label{display:block;font-size:13px;margin-bottom:6px;font-weight:600;color:#eaf2ff}
  input,select,textarea{
    width:100%;
    padding:10px 12px;
    border-radius:10px;
    border:none;
    background:rgba(255,255,255,0.18);
    color:#001;
    font-weight:500;
    outline:none;
  }
  textarea{min-height:80px;resize:vertical}

  .full { grid-column:1 / -1; display:block }

  .actions{ display:flex; gap:10px; margin-top:12px; flex-wrap:wrap }
  .btn{
    background:var(--accent);
    color:var(--white);
    border:none;
    padding:10px 16px;
    border-radius:10px;
    font-weight:700;
    cursor:pointer;
    transition:0.22s;
  }
  .btn.back{ background:#0b61a9 }
  .btn.danger{ background:#c62828 }
  .btn:hover{ transform:translateY(-3px); box-shadow:0 12px 24px rgba(0,0,0,0.28) }
  .muted{ color:rgba(255,255,255,0.8); font-size:13px; margin-top:8px }

  table{width:100%;border-collapse:collapse;margin-top:12px}
  th,td{padding:10px;text-align:left;border-bottom:1px solid rgba(255,255,255,0.06); color:#fff}
  th{font-weight:700;background:rgba(0,0,0,0.08)}
  .center{text-align:center}

  .previewBox{
    background:rgba(255,255,255,0.95);
    color:#000;
    padding:16px;
    border-radius:10px;
  }

  @media (max-width:720px){
    form.grid{grid-template-columns:1fr}
  }
  input, select, textarea {
    width:100%;
    padding:10px 12px;
    border-radius:10px;
    border:1px solid rgba(255,255,255,0.12);
    background:rgba(255,255,255,0.08);
    color:#001;
    font-weight:500;
    outline:none;
    transition: box-shadow .18s ease, border-color .18s ease, background .18s ease;
  }

  input:hover, select:hover, textarea:hover,
  input:focus, select:focus, textarea:focus {
    border-color: #6ecbff; /* soft blue */
    box-shadow: 0 0 8px rgba(110,203,255,0.35); /* soft blue glow */
    background: rgba(110,203,255,0.15); /* very light blue tint */
  }


</style>
</head>
<body>
  <header>
    <h1>CV Raman University — Online Exam Form & Result Portal</h1>
  </header>

  <div class="container">
    <div class="menu">
      <button onclick="show('pageExam')">Exam Form</button>
      <button onclick="show('pageCheck')">Check Result</button>
      <button onclick="show('pageAdminLogin')">Admin</button>
    </div>

    <!-- EXAM FORM PAGE -->
    <section id="pageExam" class="page">
      <div class="card">
        <h2>Examination Form</h2>

        <form id="examForm" class="grid" onsubmit="event.preventDefault(); previewExam()">
          <div>
            <label for="ef_name">Full Name *</label>
            <input id="ef_name" name="ef_name" type="text" />
          </div>
          <div>
            <label for="ef_roll">Roll Number *</label>
            <input id="ef_roll" name="ef_roll" type="text" />
          </div>

          <div>
            <label for="ef_enroll">Enrollment Number *</label>
            <input id="ef_enroll" name="ef_enroll" type="text" />
          </div>
          <div>
            <label for="ef_aadhar">Aadhaar Number *</label>
            <input id="ef_aadhar" name="ef_aadhar" type="text" />
          </div>

          <div>
            <label for="ef_fname">Father's Name *</label>
            <input id="ef_fname" name="ef_fname" type="text" />
          </div>
          <div>
            <label for="ef_mname">Mother's Name *</label>
            <input id="ef_mname" name="ef_mname" type="text" />
          </div>

          <div>
            <label for="ef_course">Course *</label>
            <select id="ef_course" name="ef_course">
              <option value="">Select Course</option>
              <option value="B.Tech">B.Tech</option>
              <option value="BCA">BCA</option>
              <option value="B.Sc">B.Sc</option>
              <option value="Diploma">Diploma</option>
            </select>
          </div>

          <div>
            <label for="ef_branch">Branch *</label>
            <select id="ef_branch" name="ef_branch">
              <option value="">Select Branch</option>
              <option value="CSE">CSE</option>
              <option value="IT">IT</option>
              <option value="ECE">ECE</option>
              <option value="EE">EE</option>
              <option value="ME">ME</option>
            </select>
          </div>

          <div>
            <label for="ef_sem">Semester *</label>
            <select id="ef_sem" name="ef_sem">
              <option value="">Select Semester</option>
              <option>1st</option><option>2nd</option><option>3rd</option><option>4th</option>
              <option>5th</option><option>6th</option><option>7th</option><option>8th</option>
            </select>
          </div>

          <div class="full">
            <label for="ef_address">Full Address *</label>
            <textarea id="ef_address" name="ef_address"></textarea>
          </div>

          <div>
            <label for="ef_email">Email *</label>
            <input id="ef_email" name="ef_email" type="email" />
          </div>
          <div>
            <label for="ef_mobile">Mobile Number *</label>
            <input id="ef_mobile" name="ef_mobile" type="tel" />
          </div>

          <div class="full">
            <label><input id="ef_decl" type="checkbox" /> &nbsp; I declare that the above information is correct. *</label>
          </div>

          <div class="full actions">
            <button class="btn" type="submit">Preview Form</button>
            <!-- Reset fixed to reset the form element -->
            <button class="btn back" type="button" onclick="document.getElementById('examForm').reset()">Reset</button>
          </div>

          <div class="full muted" id="examMsg"></div>
        </form>
      </div>
    </section>

    <!-- EXAM PREVIEW -->
    <section id="pagePreview" class="page">
      <div class="card">
        <h2>Form Preview</h2>
        <div class="previewBox" id="previewBoxHtml"></div>

        <div class="actions" style="margin-top:12px">
          <button class="btn" onclick="confirmExam()">Confirm & Submit</button>
          <button class="btn back" onclick="show('pageExam')">Back to Edit</button>
        </div>
        <div id="previewMsg" class="muted"></div>
      </div>
    </section>

    <!-- CHECK RESULT PAGE -->
    <section id="pageCheck" class="page">
      <div class="card">
        <h2>Check Result</h2>

        <div class="grid">
          <div>
            <label for="chk_name">Full Name *</label>
            <input id="chk_name" />
          </div>
          <div>
            <label for="chk_roll">Roll Number *</label>
            <input id="chk_roll" />
          </div>
          <div>
            <label for="chk_sem">Semester *</label>
            <select id="chk_sem">
              <option value="">Select Semester</option>
              <option>1st</option><option>2nd</option><option>3rd</option><option>4th</option>
              <option>5th</option><option>6th</option><option>7th</option><option>8th</option>
            </select>
          </div>

          <div class="full actions">
            <button class="btn" onclick="checkResult()">View Result</button>
            <button class="btn back" onclick="show('pageExam')">Back</button>
          </div>
        </div>

        <div id="resultBox" style="margin-top:12px"></div>
      </div>
    </section>

    <!-- ADMIN LOGIN -->
    <section id="pageAdminLogin" class="page">
      <div class="card">
        <h2>Admin Login</h2>
        <form onsubmit="event.preventDefault(); adminLogin()" class="grid">
          <div>
            <label for="admin_user">Username *</label>
            <input id="admin_user" />
          </div>
          <div>
            <label for="admin_pass">Password *</label>
            <input id="admin_pass" type="password" />
          </div>

          <div class="full actions">
            <button class="btn" type="submit">Login</button>
            <button class="btn back" type="button" onclick="show('pageExam')">Back</button>
          </div>
          <div id="adminLoginMsg" class="muted"></div>
        </form>
      </div>
    </section>

    <!-- ADMIN PANEL -->
    <section id="pageAdmin" class="page">
      <div class="card">
        <h2>Admin Panel</h2>

        <div class="actions">
          <button class="btn" onclick="show('pageAddStudent')">Add Student</button>
          <button class="btn" onclick="show('pageUpload')">Upload Result</button>
          <button class="btn" onclick="show('pageStudentList')">View Student List</button>
          <button class="btn danger" onclick="logoutAdmin()">Logout</button>
        </div>

        <div id="adminInfo" class="muted" style="margin-top:12px"></div>
      </div>
    </section>

    <!-- ADMIN -> ADD STUDENT -->
    <section id="pageAddStudent" class="page">
      <div class="card">
        <h2>Add Student (Admin)</h2>
        <form id="addStudentForm" onsubmit="event.preventDefault(); addStudent()" class="grid">
          <div>
            <label for="as_name">Student Name *</label>
            <input id="as_name" />
          </div>
          <div>
            <label for="as_roll">Roll Number *</label>
            <input id="as_roll" />
          </div>
          <div>
            <label for="as_branch">Branch *</label>
            <select id="as_branch">
              <option value="">Select</option>
              <option>CSE</option><option>IT</option><option>ECE</option><option>EE</option><option>ME</option>
            </select>
          </div>
          <div>
            <label for="as_sem_add">Semester *</label>
            <select id="as_sem_add">
              <option value="">Select Semester</option>
              <option>1st</option><option>2nd</option><option>3rd</option><option>4th</option>
              <option>5th</option><option>6th</option><option>7th</option><option>8th</option>
            </select>
          </div>

          <div class="full actions">
            <button class="btn" type="submit">Add Student</button>
            <button class="btn back" type="button" onclick="show('pageAdmin')">Back</button>
          </div>
          <div id="addStudentMsg" class="muted"></div>
        </form>
      </div>
    </section>

    <!-- ADMIN -> UPLOAD RESULT -->
    <section id="pageUpload" class="page">
      <div class="card">
        <h2>Upload Result (Admin)</h2>
        <form onsubmit="event.preventDefault(); uploadResult()" class="grid">
          <div>
            <label for="ur_roll">Roll Number *</label>
            <input id="ur_roll" />
          </div>
          <div>
            <label for="ur_name">Student Name *</label>
            <input id="ur_name" />
          </div>
          <div>
            <label for="ur_marks">Marks *</label>
            <input id="ur_marks" placeholder="e.g., 480/500 or 78%" />
          </div>

          <div class="full actions">
            <button class="btn" type="submit">Upload Result</button>
            <button class="btn back" type="button" onclick="show('pageAdmin')">Back</button>
          </div>

          <div id="uploadMsg" class="muted"></div>
        </form>
      </div>
    </section>

    <!-- STUDENT LIST (ADMIN ONLY) -->
    <section id="pageStudentList" class="page">
      <div class="card">
        <h2>Students & Results</h2>

        <button class="btn back" type="button" onclick="show('pageAdmin')" style="margin-bottom:12px">Back</button>

        <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:12px">
          <select id="filterBranch" onchange="renderStudentList()" style="min-width:180px">
            <option value="">All Branches</option>
            <option>CSE</option><option>IT</option><option>ECE</option><option>EE</option><option>ME</option>
          </select>

          <input id="searchBox" placeholder="Search by name or roll" style="padding:10px;border-radius:10px;border:none;min-width:220px" oninput="renderStudentList()" />
          <button class="btn back" onclick="clearAllData()" title="Remove all saved data (students & results)">Clear All</button>
        </div>

        <div id="studentTableWrap">
          <table id="studentTable">
            <thead><tr><th>Name</th><th>Roll</th><th>Branch</th><th>Semester</th><th>Result</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="muted" style="margin-top:12px">Note: Data is stored locally in your browser (localStorage).</div>
      </div>
    </section>

  </div> <!-- container -->

<script>
/* ---------- Utilities ---------- */
function show(pageId){
  document.querySelectorAll('.page').forEach(p=>p.style.display='none');
  const el = document.getElementById(pageId);
  if(el) el.style.display='block';
  if(pageId==='pageStudentList') renderStudentList();
}

/* localStorage keys */
const KEY_STUD = 'exam_students_v1';
const KEY_FORMS = 'exam_forms_v1';
function loadStudentsData(){ return JSON.parse(localStorage.getItem(KEY_STUD) || '[]'); }
function saveStudentsData(arr){ localStorage.setItem(KEY_STUD, JSON.stringify(arr)); }
function loadForms(){ return JSON.parse(localStorage.getItem(KEY_FORMS) || '{}'); }
function saveForms(obj){ localStorage.setItem(KEY_FORMS, JSON.stringify(obj)); }

/* ---------- Exam form preview & confirm ---------- */
function checkRequired(ids){
  for(let id of ids){
    const el = document.getElementById(id);
    if(!el) return false;
    if(el.type === 'checkbox'){
      if(!el.checked) return false;
    } else {
      if(String(el.value || '').trim() === '') return false;
    }
  }
  return true;
}

function previewExam(){
  const required = ['ef_name','ef_roll','ef_enroll','ef_aadhar','ef_fname','ef_mname','ef_course','ef_branch','ef_sem','ef_address','ef_email','ef_mobile','ef_decl'];
  if(!checkRequired(required)){
    alert('Please fill ALL required fields and accept the declaration.');
    return;
  }

  const s = {
    name: document.getElementById('ef_name').value.trim(),
    roll: document.getElementById('ef_roll').value.trim(),
    enroll: document.getElementById('ef_enroll').value.trim(),
    aadhar: document.getElementById('ef_aadhar').value.trim(),
    fname: document.getElementById('ef_fname').value.trim(),
    mname: document.getElementById('ef_mname').value.trim(),
    course: document.getElementById('ef_course').value,
    branch: document.getElementById('ef_branch').value,
    semester: document.getElementById('ef_sem').value,
    address: document.getElementById('ef_address').value.trim(),
    email: document.getElementById('ef_email').value.trim(),
    mobile: document.getElementById('ef_mobile').value.trim()
  };

  localStorage.setItem('temp_exam_preview', JSON.stringify(s));

  const previewBox = document.getElementById('previewBoxHtml');
  previewBox.innerHTML = `
    <div><b>Name:</b> ${s.name}</div>
    <div><b>Roll:</b> ${s.roll}</div>
    <div><b>Enrollment:</b> ${s.enroll}</div>
    <div><b>Aadhaar:</b> ${s.aadhar}</div>
    <div><b>Father:</b> ${s.fname}</div>
    <div><b>Mother:</b> ${s.mname}</div>
    <div><b>Course:</b> ${s.course}</div>
    <div><b>Branch:</b> ${s.branch}</div>
    <div><b>Semester:</b> ${s.semester}</div>
    <div><b>Address:</b> ${s.address}</div>
    <div><b>Email:</b> ${s.email}</div>
    <div><b>Mobile:</b> ${s.mobile}</div>`;

  show('pagePreview');
}

function confirmExam(){
  const temp = JSON.parse(localStorage.getItem('temp_exam_preview') || 'null');
  if(!temp){ alert('No form to submit.'); return; }

  // Save the full form details keyed by roll
  const forms = loadForms();
  forms[temp.roll] = temp;
  saveForms(forms);

  // Add or update student in student list
  const students = loadStudentsData();
  const exists = students.find(s => s.roll === temp.roll);
  if(!exists){
    students.push({
      name: temp.name,
      roll: temp.roll,
      branch: temp.branch,
      semester: temp.semester,
      course: temp.course,
      enroll: temp.enroll,
      result: 'Not Uploaded'
    });
  } else {
    // update existing
    exists.name = temp.name;
    exists.branch = temp.branch;
    exists.semester = temp.semester;
    exists.course = temp.course;
    exists.enroll = temp.enroll;
  }
  saveStudentsData(students);

  localStorage.removeItem('temp_exam_preview');

  document.getElementById('previewMsg').innerText = '✔ Form submitted and saved.';
  setTimeout(()=>{
    show('pageExam');
    document.getElementById('examForm').reset();
    document.getElementById('previewMsg').innerText = '';
    renderStudentList();
  }, 600);
}

/* ---------- Check result ---------- */
function checkResult(){
  const name = document.getElementById('chk_name').value.trim();
  const roll = document.getElementById('chk_roll').value.trim();
  const sem = document.getElementById('chk_sem').value.trim();

  if(!name || !roll || !sem){ alert('Please enter Name, Roll and Semester.'); return; }

  const students = loadStudentsData();
  // Require all three to match: name (case-insensitive), roll, and semester
  const student = students.find(s => 
    String(s.roll || '').toLowerCase() === roll.toLowerCase() &&
    String(s.name || '').toLowerCase() === name.toLowerCase() &&
    String(s.semester || '').toLowerCase() === sem.toLowerCase()
  );

  if(!student){
    document.getElementById('resultBox').innerHTML = '<div class="muted">❌ No student found with these details.</div>';
    return;
  }

  document.getElementById('resultBox').innerHTML = `<div class="previewBox"><b>${student.name}</b><br>Roll: ${student.roll}<br>Branch: ${student.branch}<br>Semester: ${student.semester || ''}<br>Result: ${student.result || 'Not Uploaded'}</div>`;
}

/* ---------- Admin login / panel ---------- */
function adminLogin(){
  const u = document.getElementById('admin_user').value.trim();
  const p = document.getElementById('admin_pass').value.trim();
  if(u === 'admin' && p === '1234'){
    document.getElementById('adminLoginMsg').innerText = '';
    show('pageAdmin');
    document.getElementById('admin_user').value = '';
    document.getElementById('admin_pass').value = '';
    document.getElementById('adminInfo').innerText = 'Logged in as admin';
  } else {
    document.getElementById('adminLoginMsg').innerText = 'Invalid credentials';
  }
}
function logoutAdmin(){ show('pageExam'); document.getElementById('adminInfo').innerText = ''; }

/* ---------- Admin: add student ---------- */
function addStudent(){
  const name = document.getElementById('as_name').value.trim();
  const roll = document.getElementById('as_roll').value.trim();
  const branch = document.getElementById('as_branch').value.trim();
  const sem = document.getElementById('as_sem_add').value.trim();
  const msgEl = document.getElementById('addStudentMsg');

  msgEl.style.color = 'red';
  if(!name || !roll || !branch || !sem){
    msgEl.innerText = 'All fields are mandatory';
    return;
  }

  const students = loadStudentsData();
  if(students.find(s=>s.roll.toLowerCase()===roll.toLowerCase())){
    msgEl.innerText = 'Student with this roll already exists';
    return;
  }

  students.push({
    name: name,
    roll: roll,
    branch: branch,
    semester: sem,
    result: 'Not Uploaded',
    course: '',
    enroll: ''
  });
  saveStudentsData(students);

  msgEl.style.color = 'limegreen';
  msgEl.innerText = '✔ Student added';
  document.getElementById('as_name').value = '';
  document.getElementById('as_roll').value = '';
  document.getElementById('as_branch').value = '';
  document.getElementById('as_sem_add').value = '';

  renderStudentList();
}

/* ---------- Admin: upload result ---------- */
function uploadResult(){
  const roll = document.getElementById('ur_roll').value.trim();
  const name = document.getElementById('ur_name').value.trim();
  const marks = document.getElementById('ur_marks').value.trim();
  const msg = document.getElementById('uploadMsg');

  msg.style.color = 'red';
  if(!roll || !name || !marks){ msg.innerText = 'All fields mandatory'; return; }

  const students = loadStudentsData();
  const s = students.find(x => x.roll === roll && x.name.toLowerCase() === name.toLowerCase());
  if(!s){ msg.innerText = 'Student not found (add first)'; return; }

  s.result = marks;
  saveStudentsData(students);

  msg.style.color = 'limegreen';
  msg.innerText = '✔ Result uploaded';
  document.getElementById('ur_roll').value=''; document.getElementById('ur_name').value=''; document.getElementById('ur_marks').value='';
  renderStudentList();
}

/* ---------- Render student list ---------- */
function renderStudentList(){
  const tbody = document.querySelector('#studentTable tbody');
  tbody.innerHTML = '';

  const branch = (document.getElementById('filterBranch') || {value:''}).value.trim();
  const q = (document.getElementById('searchBox') || {value:''}).value.trim().toLowerCase();

  let students = loadStudentsData();
  if(branch) students = students.filter(s=>s.branch===branch);
  if(q) students = students.filter(s => (s.name||'').toLowerCase().includes(q) || (s.roll||'').toLowerCase().includes(q));

  if(students.length===0){
    tbody.innerHTML = '<tr><td colspan="5" class="center">No students found</td></tr>';
    return;
  }

  students.forEach(s=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${s.name}</td><td>${s.roll}</td><td>${s.branch}</td><td>${s.semester||''}</td><td>${s.result||'Not Uploaded'}</td>`;
    tbody.appendChild(tr);
  });
}

/* ---------- Clear all data ---------- */
function clearAllData(){
  if(!confirm('This will remove ALL saved students & forms and cannot be undone. Continue?')) return;
  localStorage.removeItem(KEY_STUD);
  localStorage.removeItem(KEY_FORMS);
  renderStudentList();
  alert('All data cleared');
}

/* ---------- Init ---------- */
show('pageExam');
renderStudentList();
</script>

</body>
</html>

